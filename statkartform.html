<!DOCTYPE HTML>
<html>
    <head>
        <script src="jquery-2.1.1.js"></script>
        <script src="statkart.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css">
		 <script src="http://openlayers.org/api/OpenLayers.js"></script>
    </head>
    <body>
<form method="get" action="statkartutsktift.html">
    UTM: <select name="UTM">
        <option value="32">32</option>
        <option value="33">33</option>
        <option value="34">34</option>
        <option value="35">35</option>
        <option value="36">36</option>
        </select><br/>
    Øst koordinat <input type="number" id="east" name="x"  step="any" value=557000></input></br>
    Nord koordinat <input type="number" id="north" name="y"  step="any"     value=7037000></input></br>
    Skala 1:<input type="number" name="resolution" step="any" value=50000></input></br>
    Zoom (oppløsning, høyere gir bedre oppløsning, kun heltall): <input type="number" name="zoom" step=1 value=13></input><br/>
    Kart <select name="map">
        <option value="toporaster2">Topografisk</option>
        <option value="sjo_hovedkart2">Sjøkart</option>
        </select><br/>
    Ark <select oninput="changePaper(this.value)" name="paper">
            <option value="A3Landscape">A3 liggende</option>
            <option value="A3">A3 stående</option>
            <option value="A4Landscape">A4 liggende</option>
            <option value="A4">A4 stående</option>
        </select></br>
    <input type="submit" value="Gi meg kartet!"></input>
    </form>
<br/>
Siden er lagd for chrome, det anbefales og lagre til pdf først og så skrive ut pdf. Husk å velg "crop to size" eller noe sånt (slik at du får rett skala) når du skriver ut.
<div id="map" style="width:500px;height:500px;top:300px;left:50px;position:absolute;">
    <div id="box" style="position:absolute;top:240px;bottom:240px;left:240px;right:240px;border: 1px black solid;z-index: 800;pointer-events:none;"></div>
</div>
<script>

var map = new OpenLayers.Map('map');
map.projection = "EPSG:32633";
map.displayProjection = new OpenLayers.Projection(map.projection);
map.maxExtent = new OpenLayers.Bounds(-2500000, 3500000, 3045984, 9045984);
//map.resolutions = [1800,900,450,225,120,50,25,10,4.5,3,2,1,0.5];
map.tileSize = new OpenLayers.Size(256, 256);
var ign = new OpenLayers.Layer.WMS( "Topo2",
                                   "http://opencache.statkart.no/gatekeeper/gk/gk.open", {layers: 'toporaster2'} );
map.addLayer(ign);

var resolution = 50000;
var paperWidth = .420;
var paperHeight = .297;
var mapHeight = 500;
var mapWitdth = 500;

function changePaper(paper) {
    if (paper == "A3Landscape"){
        paperWidth = .420;
        paperHeight = .297;
    } else if (paper == "A3"){
        paperWidth = .297;
        paperHeight = .420;
    } else if (paper == "A4Landscape") {
        paperWidth = .297;
        paperHeight = .210;
    } else if (paper == "A4") {
        paperWidth = .210;
        paperHeight = .297;
    }
    updateSquare();
}


function updateSquare(){
    var center = map.getLonLatFromPixel(new OpenLayers.Pixel(mapWitdth/2,mapHeight/2));
    var dx = paperWidth/2*resolution;
    var left = center.lon-dx;
    var right = center.lon+dx;
    var dy = paperHeight/2*resolution;
    var top = center.lat+dy;
    var bottom = center.lat-dy;
    loc =  map.getPixelFromLonLat(new OpenLayers.LonLat(left,top));
    var left = loc.x;
    var top = loc.y;
    loc =  map.getPixelFromLonLat(new OpenLayers.LonLat(right,bottom));
    var right = loc.x;
    var bottom = loc.y;
    var height = bottom-top;
    var width = right-left;
    
    var box = $("#box")[0];
    box.style.top = top + "px";
    box.style.left = left + "px";
    box.style.width = width + "px";
    box.style.height = height + "px";
    updateLocation()
}

function updateLocation(){
    var box = $("#box")[0];
    var y = parseInt(box.style.top);
    var x = parseInt(box.style.left);
    var loc = map.getLonLatFromPixel(new OpenLayers.Pixel(x,y));
    $("#east")[0].value = loc.lon;
                                     $("#north")[0].value = loc.lat;
}

                                   map.zoomToMaxExtent();
                                   map.events.register("zoomend",null,updateSquare);
                                   map.events.register("move",null,updateLocation);
                                   updateSquare();
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','http://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-38807768-1', 'ntnu.no');
  ga('send', 'pageview');

</script>
    </body>
</html>